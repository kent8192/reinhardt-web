{% extends "base.html" %}
{% import "macros/sidebar.html" as macros %}

{% block title %}{{ page.title }}{% endblock %}
{% block description %}{{ page.description | default(value=config.description) }}{% endblock %}
{% block og_title %}{{ page.title }}{% endblock %}
{% block og_description %}{{ page.description | default(value=config.description) }}{% endblock %}

{% block content %}
{# Determine the root section path for the sidebar from page ancestors.
   page.ancestors is a list of section paths like ["_index.md", "quickstart/_index.md", ...] #}
{% set_global root_path = "" %}
{% for ancestor in page.ancestors %}
	{% if ancestor is containing("quickstart/_index.md") %}
		{% set_global root_path = "quickstart/_index.md" %}
	{% elif ancestor is containing("docs/_index.md") %}
		{% set_global root_path = "docs/_index.md" %}
	{% endif %}
{% endfor %}

{% if root_path %}
<div class="section-layout container">
	{{ macros::sidebar(root_path=root_path, current_url=current_url) }}
	<article class="page-content" aria-label="{{ page.title }}">
		<header class="page-header">
			<h1>{{ page.title }}</h1>
			{% if page.description %}
			<p class="page-description">{{ page.description }}</p>
			{% endif %}
		</header>
		<div class="prose">
			{{ page.content | safe }}
		</div>
	</article>
</div>
{% else %}
{# Fallback for pages outside quickstart/docs (e.g. /changelog/, /security/) #}
<div class="standalone-layout container">
	<article class="page-content" aria-label="{{ page.title }}">
		<header class="page-header">
			<h1>{{ page.title }}</h1>
			{% if page.description %}
			<p class="page-description">{{ page.description }}</p>
			{% endif %}
		</header>
		<div class="prose">
			{{ page.content | safe }}
		</div>
	</article>
</div>
{% endif %}
{% endblock content %}
