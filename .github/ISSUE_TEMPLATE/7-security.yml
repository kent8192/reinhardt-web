name: Security Vulnerability
description: Report a security vulnerability
title: "[Security]: <brief description>"
labels: ["security", "critical"]
body:
	- type: markdown
		attributes:
			value: |
				## ⚠️ STOP - DO NOT USE THIS FORM FOR SECURITY VULNERABILITIES ⚠️

				**WARNING:** Issues created through this form are **PUBLIC** and visible to everyone.
				**DO NOT** report security vulnerabilities here.

				**Instead, use GitHub Security Advisories for private reporting:**
				https://github.com/kent8192/reinhardt/security/advisories/new

				If you have already entered sensitive information, close this tab immediately
				and report via Security Advisories instead.

				For detailed information, see:
				- Security Policy: https://github.com/kent8192/reinhardt/blob/main/SECURITY.md
				- Issue Guidelines: https://github.com/kent8192/reinhardt/blob/main/docs/ISSUE_GUIDELINES.md

	- type: markdown
		attributes:
			value: |
				---

	- type: textarea
		attributes:
			label: Vulnerability Description
			description: Clearly describe the security vulnerability
			placeholder: |
				Example: SQL injection vulnerability in user query builder allows
				attackers to execute arbitrary SQL queries by manipulating the
				`order_by` parameter.

				Attack vector: http://example.com/api/users?order_by=last_name;DROP TABLE users;
		validations:
			required: true

	- type: textarea
		attributes:
			label: Affected Versions
			description: Which versions are affected? Include commit hashes if applicable.
			placeholder: |
				Affected versions:
				- Development branch (commit abc123def)
				- All versions prior to v0.2.0

				Not affected:
				- v0.2.0 and later (patch available)
		validations:
			required: true

	- type: textarea
		attributes:
			label: Steps to Reproduce
			description: Detailed steps to reproduce the vulnerability
			placeholder: |
				1. Navigate to: http://example.com/api/users
				2. Add parameter: ?order_by=last_name;DROP TABLE users;
				3. Observe: Users table is dropped
				4. Result: Database integrity compromised
		validations:
			required: true

	- type: textarea
		attributes:
			label: Proof of Concept (Optional)
			description: If available, provide a working proof of concept
			placeholder: |
				```bash
				curl "http://example.com/api/users?order_by=last_name;DROP TABLE users;"
				```

				Expected: SQL injection occurs, users table is dropped
			render: shell
		validations:
			required: false

	- type: dropdown
		attributes:
			label: Severity Level
			description: Estimate the severity level (maintainers will confirm)
			options:
				- Critical (CVSS 9.0-10.0)
				- High (CVSS 7.0-8.9)
				- Medium (CVSS 4.0-6.9)
				- Low (CVSS 0.1-3.9)
		validations:
			required: true

	- type: textarea
		attributes:
			label: Impact Assessment
			description: What is the impact of this vulnerability?
			placeholder: |
				- Remote code execution without authentication
				- Data integrity compromise (users can delete tables)
				- Affects all production deployments
				- No authentication required to exploit
				- Can lead to complete database compromise
		validations:
			required: true

	- type: textarea
		attributes:
			label: Proposed Mitigation
			description: Suggested fix or workaround (optional)
			placeholder: |
				Suggested fix:
				- Validate and sanitize `order_by` parameter against whitelist
				- Use parameterized queries (SeaQuery) instead of string concatenation
				- Add input validation middleware

				Workaround:
				- Disable `order_by` parameter until fix is deployed
		validations:
			required: false

	- type: checkboxes
		attributes:
			label: Confirmation
			description: Please confirm the following
			options:
				- label: "I have searched existing issues for duplicate vulnerabilities"
				  required: true
				- label: "I have NOT disclosed this vulnerability publicly"
				  required: true
				- label: "I understand this issue will be PUBLIC and I have confirmed it contains no sensitive details"
				  required: true
				- label: "I am willing to work with maintainers on coordinated disclosure"
				  required: false

	- type: textarea
		attributes:
			label: Additional Context
			description: Any other relevant information
			placeholder: |
				- Link to vulnerable code: https://github.com/kent8192/reinhardt/blob/main/src/api/users.rs#L123
				- Similar vulnerability fixed in commit def456
				- CVE reference: CVE-2024-12345
		validations:
			required: false
