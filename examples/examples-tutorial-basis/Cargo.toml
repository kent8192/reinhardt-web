[package]
name = "examples-tutorial-basis"
version = "0.1.0-alpha.1"
edition = "2024"
publish = false
description = "Reinhardt basis tutorial example - Polling application with Pages"
default-run = "examples-tutorial-basis"

[lib]
crate-type = ["cdylib", "rlib"]  # cdylib for WASM, rlib for server

[[bin]]
name = "examples-tutorial-basis"
path = "src/bin/manage.rs"

[dependencies]
# Common dependencies (both WASM and server)
serde = { version = "1.0.228", features = ["derive"] }
serde_json = "1.0.145"

# WASM-specific dependencies
[target.'cfg(target_arch = "wasm32")'.dependencies]
reinhardt = { workspace = true, features = ["pages"] }
wasm-bindgen = "0.2.106"
wasm-bindgen-futures = "0.4.56"
web-sys = { version = "0.3.83", features = [
	"Window",
	"Document",
	"Element",
	"HtmlFormElement",
	"HtmlInputElement",
	"Event",
	"EventTarget",
] }
console_error_panic_hook = "0.1"
gloo-net = "0.6"
# WASM-compatible chrono and uuid
chrono = { version = "0.4", features = ["serde", "wasmbind"] }
uuid = { version = "1.11.0", features = ["serde", "v4", "js"] }

# Server-specific dependencies
[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
reinhardt = { workspace = true, features = [
	"full",
	"pages",
	"conf",
	"commands",
	"db-sqlite",
	"forms",
	"client-router",
] }
tokio = { version = "1.48.0", features = ["full"] }
# Server-specific common dependencies
chrono = { version = "0.4", features = ["serde"] }
uuid = { version = "1.11.0", features = ["serde", "v4"] }
validator = { version = "0.20.0", features = ["derive"] }
ctor = "0.6.1"
inventory = "0.3"
linkme = "0.3"

[dev-dependencies]
reinhardt = { workspace = true, features = [
    "test",
] }
rstest = { version = "0.26", default-features = false }
serial_test = "3.2"
tokio = { version = "1.48.0", features = ["rt", "macros"] }
sqlx = { version = "0.8", features = ["runtime-tokio", "sqlite"] }
tempfile = "3.15"

# WASM-specific dev-dependencies
[target.'cfg(target_arch = "wasm32")'.dev-dependencies]
wasm-bindgen-test = "0.3.56"

[build-dependencies]
cfg_aliases = "0.2"

[features]
default = ["with-reinhardt", "client-router"]
# client-router: Enable client-side routing support (required for #[routes] macro with UnifiedRouter)
client-router = []
with-reinhardt = []

[[test]]
name = "integration"
required-features = ["with-reinhardt"]

[lints.rust]
unexpected_cfgs = { level = "warn", check-cfg = ["cfg(with_reinhardt)"] }
