[config]
default_to_workspace = false

[tasks.help]
description = "Show available commands"
script = '''
echo "Available commands:"
echo ""
echo "Setup:"
echo "  cargo make setup           - Initial setup (.env file creation)"
echo ""
echo "Running Examples:"
echo "  cargo make run-rest        - Run rest-api example server"
echo "  cargo make run-db          - Run database-integration example"
echo ""
echo "Testing:"
echo "  cargo make test            - Test all examples"
echo "  cargo make test-keep       - Test examples (alias for test)"
echo "  cargo make test-hello      - Test hello-world example"
echo "  cargo make test-rest       - Test rest-api example"
echo "  cargo make test-db         - Test database-integration example"
echo ""
echo "Maintenance:"
echo "  cargo make clean           - Clean build artifacts"
'''

[tasks.setup]
description = "Initial setup (.env file creation)"
script = '''
if [ ! -f .env ]; then
  cp .env.example .env
  echo "✅ .env file created"
else
  echo "⚠️  .env file already exists"
fi
'''

[tasks.test]
description = "Test all examples"
command = "cargo"
args = ["test", "--workspace"]

[tasks.test-keep]
description = "Test examples (alias for test)"
dependencies = ["test"]

[tasks.clean]
description = "Clean build artifacts"
script = '''
cargo clean
echo "✅ Build artifacts removed"
'''

# Example-specific tasks - Running

[tasks.run-rest]
description = "Run rest-api example server"
cwd = "rest-api"
command = "cargo"
args = ["run", "--bin", "manage", "runserver"]

[tasks.run-db]
description = "Run database-integration example"
cwd = "database-integration"
command = "cargo"
args = ["run", "--bin", "manage", "runserver"]

# Example-specific tasks - Testing

[tasks.test-hello]
description = "Test hello-world example"
cwd = "hello-world"
command = "cargo"
args = ["test"]

[tasks.test-rest]
description = "Test rest-api example"
cwd = "rest-api"
command = "cargo"
args = ["test"]

[tasks.test-db]
description = "Test database-integration example"
cwd = "database-integration"
command = "cargo"
args = ["test"]
