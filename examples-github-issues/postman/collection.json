{
	"info": {
		"name": "Reinhardt examples-github-issues",
		"description": "GitHub Issues Management GraphQL API Tests with JWT Authentication",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Register User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { register(input: { username: \\\"testuser\\\", email: \\\"test@example.com\\\", password: \\\"password123\\\", firstName: \\\"Test\\\", lastName: \\\"User\\\" }) { token user { id username email firstName lastName isActive dateJoined } } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Registration successful', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.register) {",
									"        pm.expect(jsonData.data.register.token).to.be.a('string');",
									"        pm.expect(jsonData.data.register.user.username).to.eql('testuser');",
									"        pm.environment.set('authToken', jsonData.data.register.token);",
									"        pm.environment.set('userId', jsonData.data.register.user.id);",
									"    } else if (jsonData.errors) {",
									"        console.log('GraphQL Error (may be duplicate user):', jsonData.errors);",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Login User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { login(input: { username: \\\"testuser\\\", password: \\\"password123\\\" }) { token user { id username email } } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Login successful', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.login) {",
									"        pm.expect(jsonData.data.login.token).to.be.a('string');",
									"        pm.environment.set('authToken', jsonData.data.login.token);",
									"        pm.environment.set('userId', jsonData.data.login.user.id);",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Get Current User (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { me { id username email firstName lastName isActive isStaff dateJoined } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Current user retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.me) {",
									"        pm.expect(jsonData.data.me.username).to.eql('testuser');",
									"    }",
									"});"
								]
							}
						}
					]
				}
			]
		},
		{
			"name": "Users",
			"item": [
				{
					"name": "List All Users",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { users { id username email firstName lastName } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Users list retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.users) {",
									"        pm.expect(jsonData.data.users).to.be.an('array');",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Get User by ID",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { user(id: \\\"{{userId}}\\\") { id username email } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('User retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.user) {",
									"        pm.expect(jsonData.data.user.username).to.eql('testuser');",
									"    }",
									"});"
								]
							}
						}
					]
				}
			]
		},
		{
			"name": "Projects",
			"item": [
				{
					"name": "Create Project (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { createProject(input: { name: \\\"Test Project\\\", description: \\\"A test project for API testing\\\" }) { id name description createdAt } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Project created', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.createProject) {",
									"        pm.expect(jsonData.data.createProject.name).to.eql('Test Project');",
									"        pm.environment.set('projectId', jsonData.data.createProject.id);",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "List Projects",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { projects { id name description } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Projects list retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.projects) {",
									"        pm.expect(jsonData.data.projects).to.be.an('array');",
									"    }",
									"});"
								]
							}
						}
					]
				}
			]
		},
		{
			"name": "Issues",
			"item": [
				{
					"name": "Create Issue (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { createIssue(input: { projectId: \\\"{{projectId}}\\\", title: \\\"Test Issue\\\", body: \\\"This is a test issue for API testing\\\" }) { id number title body state authorId projectId createdAt } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issue created', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.createIssue) {",
									"        pm.expect(jsonData.data.createIssue.title).to.eql('Test Issue');",
									"        pm.expect(jsonData.data.createIssue.state).to.eql('open');",
									"        pm.environment.set('issueId', jsonData.data.createIssue.id);",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "List Issues",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { issues(projectId: \\\"{{projectId}}\\\") { id number title body state } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issues list retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.issues) {",
									"        pm.expect(jsonData.data.issues).to.be.an('array');",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Get Issue by ID",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"query { issue(id: \\\"{{issueId}}\\\") { id number title body state projectId authorId } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issue retrieved', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.issue) {",
									"        pm.expect(jsonData.data.issue.title).to.eql('Test Issue');",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Update Issue (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { updateIssue(id: \\\"{{issueId}}\\\", input: { title: \\\"Updated Test Issue\\\", body: \\\"This issue has been updated\\\" }) { id title body state } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issue updated', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.updateIssue) {",
									"        pm.expect(jsonData.data.updateIssue.title).to.eql('Updated Test Issue');",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Close Issue (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { closeIssue(id: \\\"{{issueId}}\\\") { id state } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issue closed', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.closeIssue) {",
									"        pm.expect(jsonData.data.closeIssue.state).to.eql('closed');",
									"    }",
									"});"
								]
							}
						}
					]
				},
				{
					"name": "Reopen Issue (Authenticated)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{authToken}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"query\": \"mutation { reopenIssue(id: \\\"{{issueId}}\\\") { id state } }\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/graphql",
							"host": ["{{baseUrl}}"],
							"path": ["graphql"]
						}
					},
					"response": [],
					"event": [
						{
							"listen": "test",
							"script": {
								"type": "text/javascript",
								"exec": [
									"pm.test('Status code is 200', function() {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Issue reopened', function() {",
									"    var jsonData = pm.response.json();",
									"    if (jsonData.data && jsonData.data.reopenIssue) {",
									"        pm.expect(jsonData.data.reopenIssue.state).to.eql('open');",
									"    }",
									"});"
								]
							}
						}
					]
				}
			]
		}
	]
}
