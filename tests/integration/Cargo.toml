[package]
name = "reinhardt-integration-tests"
version = "0.1.0"
edition = "2021"
publish = false

[dependencies]
# Reinhardt crates
reinhardt-contrib = { path = "../../crates/reinhardt-contrib", features = [
  "sitemaps-cache",
  "sitemaps-http",
  "sitemaps-i18n",
  "sitemaps-orm",
] }
reinhardt-auth = { path = "../../crates/reinhardt-auth" }
reinhardt-security = { path = "../../crates/reinhardt-security" }
reinhardt-middleware = { path = "../../crates/reinhardt-middleware" }
reinhardt-templates = { path = "../../crates/reinhardt-templates" }
reinhardt-apps = { path = "../../crates/reinhardt-apps" }
reinhardt-routers = { path = "../../crates/reinhardt-routers" }
reinhardt-viewsets = { path = "../../crates/reinhardt-viewsets" }
reinhardt-openapi = { path = "../../crates/reinhardt-openapi" }
reinhardt-graphql = { path = "../../crates/reinhardt-graphql" }
reinhardt-orm = { path = "../../crates/reinhardt-orm", features = [
  "django-compat",
] }
reinhardt-migrations = { path = "../../crates/reinhardt-migrations" }
reinhardt-database = { path = "../../crates/reinhardt-database", features = [
  "postgres",
  "sqlite",
] }
reinhardt-metadata = { path = "../../crates/reinhardt-metadata" }
reinhardt-versioning = { path = "../../crates/reinhardt-versioning" }
reinhardt-messages = { path = "../../crates/reinhardt-messages" }
reinhardt-parsers = { path = "../../crates/reinhardt-parsers" }
reinhardt-exception = { path = "../../crates/reinhardt-exception" }
reinhardt-types = { path = "../../crates/reinhardt-types" }
reinhardt-signals = { path = "../../crates/reinhardt-signals" }
reinhardt-websockets = { path = "../../crates/reinhardt-websockets" }
reinhardt-http = { path = "../../crates/reinhardt-http" }
reinhardt-server = { path = "../../crates/reinhardt-server" }
reinhardt-logging = { path = "../../crates/reinhardt-logging" }
reinhardt-mail = { path = "../../crates/reinhardt-mail" }
reinhardt-di = { path = "../../crates/reinhardt-di" }
reinhardt-macros = { path = "../../crates/reinhardt-macros" }
reinhardt-static = { path = "../../crates/reinhardt-static" }
reinhardt-cache = { path = "../../crates/reinhardt-cache" }
reinhardt-views = { path = "../../crates/reinhardt-views" }
reinhardt-negotiation = { path = "../../crates/reinhardt-negotiation" }
reinhardt-renderers = { path = "../../crates/reinhardt-renderers" }
reinhardt-validators = { path = "../../crates/reinhardt-validators" }
reinhardt-serializers = { path = "../../crates/reinhardt-serializers" }
reinhardt-settings = { path = "../../crates/reinhardt-settings" }
reinhardt-browsable-api = { path = "../../crates/reinhardt-browsable-api" }
reinhardt-i18n = { path = "../../crates/reinhardt-i18n" }
reinhardt-tasks = { path = "../../crates/reinhardt-tasks" }
reinhardt-rest = { path = "../../crates/reinhardt-rest" }
reinhardt-pagination = { path = "../../crates/reinhardt-pagination" }
reinhardt-filters = { path = "../../crates/reinhardt-filters" }
reinhardt-forms = { path = "../../crates/reinhardt-forms" }
reinhardt-throttling = { path = "../../crates/reinhardt-throttling" }
reinhardt-utils = { path = "../../crates/reinhardt-utils" }
reinhardt-storage = { path = "../../crates/reinhardt-storage" }
reinhardt-test = { path = "../../crates/reinhardt-test" }
reinhardt-sessions = { path = "../../crates/reinhardt-sessions", features = [
  "database",
] }

# Web framework (using reinhardt-apps)
tokio = { version = "1.0", features = ["full"] }
hyper = "1.0"
http = "1.0"
async-trait = "0.1"

# Database
sqlx = { version = "0.8", features = [
  "postgres",
  "sqlite",
  "runtime-tokio-rustls",
  "chrono",
] }

# HTTP client for testing
reqwest = { version = "0.12", features = ["cookies"] }

# Serialization
serde = { version = "1.0", features = ["derive"] }
serde_json = "1.0"
bytes = "1.0"

# GraphQL
async-graphql = "7.0.17"
futures-util = "0.3"

# Utilities
chrono = "0.4"
uuid = { version = "1.0", features = ["v4"] }
anyhow = "1.0"
base64 = "0.22"
percent-encoding = "2.3"
unic-langid = "0.9"
once_cell = "1.20"
serial_test = "3.2"

# Templates
askama = "0.12"

# Testing utilities
tempfile = "3.14"

[features]
testcontainers = []

[dev-dependencies]
# Test utilities
tokio-test = "0.4"
testcontainers = { workspace = true }
testcontainers-modules = { workspace = true }

[[test]]
name = "parser_integration"
path = "tests/parser_integration.rs"

[[test]]
name = "router_viewset_integration"
path = "tests/router_viewset_integration.rs"

[[test]]
name = "router_schema_integration"
path = "tests/router_schema_integration.rs"

[[test]]
name = "router_auth_integration"
path = "tests/router_auth_integration.rs"

[[test]]
name = "router_template_integration"
path = "tests/router_template_integration.rs"

[[test]]
name = "security_middleware_integration"
path = "tests/security_middleware_integration.rs"

[[test]]
name = "csrf_middleware_integration"
path = "tests/csrf_middleware_integration.rs"

[[test]]
name = "https_redirect_integration"
path = "tests/https_redirect_integration.rs"

[[test]]
name = "auth_security_integration"
path = "tests/auth_security_integration.rs"

[[test]]
name = "session_security_integration"
path = "tests/session_security_integration.rs"

[[test]]
name = "csp_integration"
path = "tests/csp_integration.rs"

[[test]]
name = "router_lifecycle_integration"
path = "tests/router_lifecycle_integration.rs"

[[test]]
name = "router_websocket_integration"
path = "tests/router_websocket_integration.rs"

[[test]]
name = "server_integration_tests"
path = "tests/server_integration_tests.rs"

[[test]]
name = "logging_email_integration"
path = "tests/logging_email_integration_tests.rs"

[[test]]
name = "openapi_schema_integration"
path = "tests/openapi_schema_integration.rs"

[[test]]
name = "sitemap_http_integration"
path = "tests/sitemap_http_tests.rs"

# Migrated integration tests from individual crates
# Temporarily disabled due to reinhardt-contrib View import error
# [[test]]
# name = "contrib_messages_integration_tests"
# path = "tests/contrib_messages_integration_tests.rs"

# [[test]]
# name = "contrib_health_integration_tests"
# path = "tests/contrib_health_integration_tests.rs"

# TODO: Fix macro injection test code - compilation errors with #[use_injection] macro usage
[[test]]
name = "macros_di_integration_tests"
path = "tests/macros_di_integration_tests.rs"

[[test]]
name = "logging_template_integration_tests"
path = "tests/logging_template_integration_tests.rs"

[[test]]
name = "logging_orm_integration_tests"
path = "tests/logging_orm_integration_tests.rs"

[[test]]
name = "mail_integration_tests"
path = "tests/mail_integration_tests.rs"

[[test]]
name = "renderers_http_integration_tests"
path = "tests/renderers_http_integration_tests.rs"

# Requires PostgreSQL database - testcontainers available but startup takes 3+ minutes
# Recommended manual setup for faster testing:
#   docker run --rm -d -p 5432:5432 -e POSTGRES_HOST_AUTH_METHOD=trust postgres:17-alpine
#   TEST_DATABASE_URL=postgres://postgres@localhost:5432/postgres cargo test -p reinhardt-integration-tests --test flatpages_integration_tests
# Uncomment to enable (warning: very slow first run due to Docker image download):
# [[test]]
# name = "flatpages_integration_tests"
# path = "../flatpages_integration_tests.rs"

[[test]]
name = "server_middleware_integration_tests"
path = "tests/server_middleware_integration_tests.rs"

[[test]]
name = "renderer_template_integration"
path = "tests/renderer_template_integration.rs"

[[test]]
name = "sitemap_advanced_tests"
path = "tests/sitemap_advanced_tests.rs"

[[test]]
name = "sitemap_advanced_real_tests"
path = "tests/sitemap_advanced_real_tests.rs"

[[test]]
name = "sitemap_i18n_mocks"
path = "tests/sitemap_i18n_mocks.rs"

[[test]]
name = "sitemap_orm_cache_mocks"
path = "tests/sitemap_orm_cache_mocks.rs"

[[test]]
name = "sitemap_orm_basic_tests"
path = "tests/sitemap_orm_basic_tests.rs"

[[test]]
name = "sitemap_cache_real_tests"
path = "tests/sitemap_cache_real_tests.rs"

[[test]]
name = "sitemap_http_real_tests"
path = "tests/sitemap_http_real_tests.rs"

[[test]]
name = "sitemap_i18n_real_tests"
path = "tests/sitemap_i18n_real_tests.rs"

[[test]]
name = "sitemap_orm_full_tests"
path = "tests/sitemap_orm_full_tests.rs"

[[test]]
name = "param_validation_integration"
path = "tests/param_validation_integration.rs"

[[test]]
name = "param_openapi_integration"
path = "tests/param_openapi_integration.rs"

[[test]]
name = "serializer_basic_integration"
path = "tests/serializer_basic_integration.rs"

[[test]]
name = "renderer_integration"
path = "tests/renderer_integration.rs"

[[test]]
name = "query_encoding_integration"
path = "tests/query_encoding_integration.rs"

[[test]]
name = "messages_framework_integration"
path = "tests/messages_framework_integration.rs"

[[test]]
name = "settings_system_integration"
path = "tests/settings_system_integration.rs"

[[test]]
name = "browsable_api_integration"
path = "tests/browsable_api_integration.rs"

[[test]]
name = "parser_advanced_integration"
path = "tests/parser_advanced_integration.rs"

[[test]]
name = "orm_model_serializer_integration"
path = "tests/orm_model_serializer_integration.rs"

[[test]]
name = "i18n_framework_integration"
path = "tests/i18n_framework_integration.rs"

[[test]]
name = "server_advanced_integration"
path = "tests/server_advanced_integration.rs"

[[test]]
name = "renderer_advanced_integration"
path = "tests/renderer_advanced_integration.rs"

[[test]]
name = "syndication_integration_tests"
path = "tests/syndication_integration_tests.rs"

[[test]]
name = "background_tasks_integration"
path = "tests/background_tasks_integration.rs"

# Migrated from reinhardt-serializers (integration tests using multiple crates)
[[test]]
name = "serializer_model_basic_tests"
path = "tests/serializer_model_basic_tests.rs"

[[test]]
name = "serializer_model_crud_tests"
path = "tests/serializer_model_crud_tests.rs"

[[test]]
name = "serializer_model_meta_tests"
path = "tests/serializer_model_meta_tests.rs"

[[test]]
name = "serializer_model_relations_tests"
path = "tests/serializer_model_relations_tests.rs"

[[test]]
name = "serializer_database_integration_tests"
path = "tests/serializer_database_integration_tests.rs"

[[test]]
name = "serializer_forms_integration_tests"
path = "tests/serializer_forms_integration_tests.rs"

[[test]]
name = "serializer_rest_integration_tests"
path = "tests/serializer_rest_integration_tests.rs"

# Migrated from reinhardt-server (integration tests using multiple crates)
[[test]]
name = "server_e2e_http_tests"
path = "tests/server_e2e_http_tests.rs"

[[test]]
name = "server_async_tests"
path = "tests/server_async_tests.rs"

[[test]]
name = "server_basic_tests"
path = "tests/server_basic_tests.rs"

[[test]]
name = "server_protocol_tests"
path = "tests/server_protocol_tests.rs"

[[test]]
name = "viewset_router_tests"
path = "viewset_router_tests.rs"

[[test]]
name = "utils_comprehensive_integration"
path = "tests/utils_comprehensive_integration.rs"

[[test]]
name = "storage_forms_integration_tests"
path = "tests/storage_forms_integration_tests.rs"

[[test]]
name = "storage_orm_integration_tests"
path = "tests/storage_orm_integration_tests.rs"

[[test]]
name = "storage_settings_integration_tests"
path = "tests/storage_settings_integration_tests.rs"

[[test]]
name = "storage_advanced_tests"
path = "tests/storage_advanced_tests.rs"

[[test]]
name = "versioning_integration_tests"
path = "tests/versioning_integration_tests.rs"

# Template integration tests
[[test]]
name = "template_renderer_advanced_integration"
path = "tests/template_renderer_advanced_integration.rs"

[[test]]
name = "template_pagination_integration"
path = "tests/template_pagination_integration.rs"

[[test]]
name = "template_i18n_integration"
path = "tests/template_i18n_integration.rs"

[[test]]
name = "template_static_integration"
path = "tests/template_static_integration.rs"

# Messages integration tests
[[test]]
name = "messages_integration"
path = "tests/messages_integration.rs"

# Pagination integration tests
[[test]]
name = "pagination_orm_integration"
path = "tests/pagination/integration_orm_tests.rs"

[[test]]
name = "pagination_rest_integration"
path = "tests/pagination/integration_rest_tests.rs"

# Database abstraction integration tests
[[test]]
name = "database_integration_tests"
path = "tests/database_integration_tests.rs"

[[test]]
name = "renderer_specialized_integration"
path = "tests/renderer_specialized_integration.rs"

[[test]]
name = "serializer_integration_tests"
path = "tests/serializer_integration_tests.rs"

# Validator integration tests
[[test]]
name = "validator_orm_integration_tests"
path = "tests/validator_orm_integration_tests.rs"

[[test]]
name = "validator_serializer_integration_tests"
path = "tests/validator_serializer_integration_tests.rs"

# Session integration tests
[[test]]
name = "session_database_tests"
path = "tests/session_database_tests.rs"
