# reinhardt-hybrid

ハイブリッドプロパティとバリデーションサポート

## 概要

インスタンス属性とクラスレベルのクエリ式の両方として機能するハイブリッドプロパティ。SQLAlchemyのハイブリッドプロパティと同様に、データベースクエリで使用できる計算プロパティを定義できます。

## 機能

### 実装済み ✓

#### HybridProperty

- **インスタンスレベルゲッター**: 構造体インスタンスで動作するゲッターを定義
  - `HybridProperty::new()` - インスタンスレベルの動作を持つプロパティを作成
  - `get()` - インスタンスの値を取得
- **SQL式サポート**: データベースクエリ用のSQL式を生成
  - `with_expression()` - SQL式生成機能を追加
  - `expression()` - SQL式文字列を取得
- **型安全**: ジェネリクス`HybridProperty<T, R>`による完全な型安全性

#### HybridMethod

- **インスタンスレベルメソッド**: パラメータを受け取るメソッドを定義
  - `HybridMethod::new()` - インスタンスレベルの動作を持つメソッドを作成
  - `call()` - 引数付きでインスタンスのメソッドを呼び出し
- **SQL式メソッド**: パラメータ化されたSQL式を生成
  - `with_expression()` - SQL式生成機能を追加
  - `expression()` - 引数付きのSQL式文字列を取得
- **型安全**: ジェネリクス`HybridMethod<T, A, R>`による完全な型安全性

#### SQL式ビルダー

- **SqlExpression構造体**: シリアライズ可能なSQL式コンテナ
  - `new()` - 文字列からSQL式を作成
  - `concat()` - CONCAT式を生成
  - `lower()` - 大文字小文字を区別しない操作のためのLOWER式を生成
  - `upper()` - 大文字小文字を区別しない操作のためのUPPER式を生成
  - `coalesce()` - NULL処理のためのCOALESCE式を生成
- **Expressionトレイト**: 型をSQL文字列に変換
  - `SqlExpression`、`String`、`&str`に実装
  - `to_sql()` - SQL文字列表現に変換

#### コンパレータシステム

- **Comparatorトレイト**: SQL比較操作をカスタマイズ
  - `new()` - 式を持つコンパレータを作成
  - `eq()`、`ne()` - 等価性と非等価性の比較
  - `lt()`、`le()`、`gt()`、`ge()` - 順序比較
- **UpperCaseComparator**: 組み込みの大文字小文字を区別しないコンパレータ
  - 比較の両側に自動的にUPPER()を適用

#### プロパティオーバーライドサポート

- **HybridPropertyOverrideトレイト**: オーバーライド可能なプロパティ動作を定義
  - `get_instance()` - インスタンスレベルの値を取得
  - `get_expression()` - SQL式を取得（オプション）
  - `set_instance()` - インスタンスレベルの値を設定（オプション）
- **OverridablePropertyラッパー**: コンポジションベースのプロパティオーバーライド
  - `new()` - カスタム実装でオーバーライド可能なプロパティを作成
  - `get()`、`set()` - インスタンスレベルのゲッターとセッター
  - `expression()` - SQL式サポート
  - 従来の継承なしで多態的な動作を可能にする

#### マクロサポート

- **hybrid_property!マクロ**: ハイブリッドプロパティを定義するための便利なマクロ

### 予定

現在、すべての予定機能は実装済みです。
